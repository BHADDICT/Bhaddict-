<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bhaddict</title>
     <link rel="icon" href="./img/logay.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
      body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 0;
    }

    .checkout-container {
      display: flex;
      flex-wrap: wrap;
      max-width: 1200px;
      margin: 30px auto;
      background: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .checkout-left, .checkout-right {
      padding: 20px;
    }

    .checkout-left {
      flex: 2;
      min-width: 300px;
    }

    .checkout-right {
      flex: 1;
      background: #fafafa;
      border-left: 1px solid #ddd;
      min-width: 250px;
    }

    input, select {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      box-sizing: border-box;
    }

    .name-fields, .small-fields {
      display: flex;
      gap: 10px;
    }

    .name-fields input, .small-fields input, .small-fields select {
      flex: 1;
    }

    .payment-box {
      background: #e6f7ff;
      padding: 10px;
      margin: 10px 0;
    }

  h2 {
    font-weight: 600;
    margin-bottom: 5px;
  }

  .subtitle {
    color: #6e6f72;
    font-size: 14px;
    margin-bottom: 20px;
  }

.payment-card {
  border: 1px solid #3b5998;
  border-radius: 6px;
  max-width: 500px;
  overflow: hidden;
  margin: 20px auto; 
  gap: 20px;
}



  .payment-header {
    background-color: #e7f0ff;
    border-bottom: 1px solid #3b5998;
    padding: 12px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .payment-header strong {
    font-weight: 600;
    font-size: 16px;
    color: #3b5998;
  }

  .payment-icons {
    display: flex;
    gap: 8px;
    align-items: center;
  }

  .payment-icons img {
    height: 26px;
    border-radius: 4px;
    box-shadow: 0 1px 2px rgb(0 0 0 / 0.1);
  }

  .payment-icons .more {
    font-weight: 600;
    font-size: 14px;
    color: #3b5998;
    padding: 0 8px;
    background: #d8e5ff;
    border-radius: 4px;
    user-select: none;
  }

  .payment-body {
    background: #f7f7f7;
    padding: 40px 20px;
    text-align: center;
    color: #505050;
    font-size: 14px;
  }

  .payment-body svg {
    fill: #a0a0a0;
    width: 70px;
    height: 50px;
    margin-bottom: 18px;
  }
    .billing-address label {
      display: block;
      margin: 5px 0;
    }

    button {
      background: #0070f3;
      color: white;
      border: none;
      padding: 12px;
      width: 100%;
      cursor: pointer;
    }

    button:hover {
      background: #005bb5;
    }

    .order-summary {
      padding: 10px;
    }

    .order-summary .item {
      display: flex;
      justify-content: space-between;
      margin: 5px 0;
    }

    .discount-code {
      width: 70%;
      padding: 8px;
      margin-top: 10px;
    }

    .apply-btn {
      width: 25%;
      padding: 8px;
      background: #555;
      color: #fff;
      border: none;
      margin-left: 5%;
    }

    .apply-btn:hover {
      background: #333;
    }

    .summary {
      margin-top: 10px;
    }
    #orderSummary {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 0 10px rgb(0 0 0 / 0.05);
  max-width: 400px;
  font-family: Arial, sans-serif;
  color: #111;
}

#orderSummary .item {
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 15px 0;
  border-bottom: 1px solid #eee;
  position: relative;
}

#orderSummary .item:last-child {
  border-bottom: none;
}

#orderSummary .item img {
  width: 64px;
  height: 64px;
  object-fit: cover;
  border-radius: 12px;
  background: #f7f7f7;
  position: relative;
  flex-shrink: 0;
}

#orderSummary .item .qty-badge {
  position: absolute;
  top: -6px;
  left: 48px;
  background: #666;
  color: #fff;
  font-size: 12px;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  line-height: 20px;
  text-align: center;
  font-weight: 600;
  box-shadow: 0 0 4px rgba(0,0,0,0.15);
}

#orderSummary .item-details {
  flex: 1;
}

#orderSummary .item-details strong {
  font-weight: 600;
  font-size: 15px;
  line-height: 1.2;
  display: block;
  margin-bottom: 4px;
}

#orderSummary .item-details .sizes {
  font-size: 13px;
  color: #666;
  letter-spacing: 0.3px;
}

#orderSummary .item-price {
  font-weight: 600;
  font-size: 15px;
  min-width: 80px;
  text-align: right;
  white-space: nowrap;
}

.discount-code {
  width: 100%;
  padding: 12px 15px;
  margin: 20px 0 15px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
}

.apply-btn {
  width: 100%;
  padding: 12px;
  background: #f2f2f2;
  color: #444;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}

.apply-btn:hover {
  background: #ddd;
}

.summary {
  font-weight: 600;
  font-size: 16px;
  margin-top: 10px;
  border-top: 1px solid #eee;
  padding-top: 15px;
}

.summary div {
  display: flex;
  justify-content: space-between;
  margin-bottom: 8px;
}

.summary div.total {
  font-size: 18px;
  font-weight: 700;
}

.shipping-info {
  font-size: 13px;
  color: #666;
  display: flex;
  justify-content: space-between;
  margin-top: 5px;
  cursor: help;
}
.payment-method {
  display: flex;
  gap: 20px;
  margin: 10px 0;
}

.payment-method label {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 14px;
  color: #333;
  cursor: pointer;
}

.payment-method input[type="radio"] {
  accent-color: #0070f3; 
  width: 16px;
  height: 16px;
}


    @media (max-width: 768px) {
      .checkout-container {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>

<div class="checkout-container">
  <div class="checkout-left">
    <h2>Contact</h2>
    <input type="email" id="email" placeholder="Email" required />

    <h2>Delivery</h2>
    <select id="regionSelect">
      <option value="">Region</option>
      <option value="MY">Phnom Penh</option>
      <option value="pr">Provinces</option>
    </select>
    <div id="provinceInputContainer" style="display:none;">
      <input type="text" id="provinceInput" placeholder="Write your province" />
    </div>
    <div class="name-fields">
      <input type="text" id="firstName" placeholder="First name" />
      <input type="text" id="lastName" placeholder="Last name" />
    </div>
    <input type="text" id="instagramInput" placeholder="Instagram username" />
    <input type="text" id="address" placeholder="Address" />
    <input type="tel" id="phone" placeholder="Phone" />

    <h2>Payment</h2>
    <div class="payment-method">
      <label><input type="radio" name="paymentMethod" value="paid" /> Paid </label>
    </div>

    <div class="payment-card">
      <div class="payment-header">
        <strong>Payment Gateway</strong>
        <div class="payment-icons">
          <img src="./img/aba.jpg" alt="ABA" />
          <img src="./img/ac.png" alt="Acleda" style="height: 20px;" />
          <div class="more">+2</div>
        </div>
      </div>
      <div class="payment-body">
        <p>After "scanning", please send the payment proof to our Telegram link below.</p>
        <p><strong id="payment-total">Total Amount: $0.00</strong></p>
        <img src="./img/qrcode.JPG" alt="ABA QR Code" style="max-width: 200px; margin: 10px auto; display: block;">
        <p style="text-align: center; margin-top: 10px;">
          <a href="https://t.me/Chea_mengheng" target="_blank" style="color: #007bff; text-decoration: underline;">
            üì© @bhaddict
          </a>
        </p>
      </div>
    </div>

    <button id="payNow">Confirm Order</button>
  </div>

  <div class="checkout-right" id="orderSummary">
 
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
window.addEventListener('load', function () {
  emailjs.init('gpdCGcS_YFBkq0RFH');

  const deliveryFee = 2.00;
  let discountRate = 0;

  // For demo/testing only: initialize cart if not present
  if (!localStorage.getItem("cartData")) {
    localStorage.setItem("cartData", JSON.stringify([
      {
        id: 1,
        name: "R√©ndezvouz ‚Äú Subtle ‚Äù Button Ups",
        price: 33.00,
        image: "./img/bo1.JPG",
        qty: 1,
        size: "M"
      },
      {
        id: 2,
        name: "R√©ndezvouz ‚Äú Subtle ‚Äù Trousers",
        price: 35.00,
        image: "./img/pro3.JPEG",
        qty: 1,
        size: "L"
      }
    ]));
  }

  function renderOrderSummary() {
    const cart = JSON.parse(localStorage.getItem("cartData")) || [];
    const summary = document.getElementById("orderSummary");
    summary.innerHTML = "";
    let subtotal = 0;

    if (cart.length === 0) {
      summary.innerHTML = "<p>Your cart is empty.</p>";
      document.getElementById("payment-total").innerHTML = "<strong>Total: $0.00</strong>";
      return;
    }

    cart.forEach(item => {
      subtotal += item.price * item.qty;
      summary.innerHTML += `
        <div class="item" style="display:flex; align-items:center; margin-bottom:10px;">
          <img src="${item.image}" alt="${item.name}" style="width:80px; height:auto; object-fit:contain; margin-right:10px;"/>
          <div style="flex:1;">
            <div><strong>${item.name}</strong> (Size: ${item.size || '-'}) √ó ${item.qty}</div>
            <div>$${(item.price * item.qty).toFixed(2)}</div>
          </div>
        </div>`;
    });

    const discountAmount = subtotal * discountRate;
    const total = subtotal - discountAmount + deliveryFee;

    summary.innerHTML += `
      <div class="summary" style="border-top:1px solid #ccc; padding-top:10px;">
        <div>Subtotal <span style="float:right;">$${subtotal.toFixed(2)}</span></div>
        ${discountRate > 0 ? `<div>Discount <span style="float:right;">-$${discountAmount.toFixed(2)}</span></div>` : ''}
        <div>Shipping <span style="float:right;">$${deliveryFee.toFixed(2)}</span></div>
        <div class="total" style="font-weight:bold; margin-top:5px;">Total <span style="float:right;">$${total.toFixed(2)}</span></div>
      </div>
      <div style="margin-top: 15px;">
        <input type="text" id="promoCodeInput" class="discount-code" placeholder="Enter promo code" />
        <button class="apply-btn" id="applyPromoBtn">Apply Promo</button>
      </div>`;

    document.getElementById("payment-total").innerHTML = `<strong>Total: $${total.toFixed(2)}</strong>`;

    document.getElementById("applyPromoBtn").addEventListener("click", function () {
      const code = document.getElementById("promoCodeInput").value.trim();
      if (code === "subtle") {
        discountRate = 0.10;
        alert("Promo applied! 10% discount.");
      } else {
        discountRate = 0;
        alert("Invalid promo code.");
      }
      renderOrderSummary();
    });
  }

  document.getElementById("regionSelect").addEventListener("change", function () {
    document.getElementById("provinceInputContainer").style.display = this.value === "pr" ? "block" : "none";
  });

  document.getElementById("payNow").addEventListener("click", function (e) {
    e.preventDefault();

    const email = document.getElementById("email").value.trim();
    const region = document.getElementById("regionSelect").value;
    const province = document.getElementById("provinceInput").value.trim();
    const firstName = document.getElementById("firstName").value.trim();
    const lastName = document.getElementById("lastName").value.trim();
    const instagram = document.getElementById("instagramInput").value.trim();
    const address = document.getElementById("address").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked');

    if (!email) {
      alert("Please enter your email.");
      return;
    }

    if (!paymentMethod) {
      alert("Please select a payment method.");
      return;
    }

    const cart = JSON.parse(localStorage.getItem("cartData")) || [];
    if (cart.length === 0) {
      alert("Your cart is empty.");
      return;
    }

    let subtotal = 0;
    const itemsHtml = cart.map(item => {
      subtotal += item.price * item.qty;
      return `
        <tr>
          <td>${item.name}</td>
          <td align="center">${item.qty}</td>
          <td align="center">${item.size || '-'}</td>
          <td align="right">$${(item.price * item.qty).toFixed(2)}</td>
        </tr>`;
    }).join('');

    const discountAmount = subtotal * discountRate;
    const total = (subtotal - discountAmount + deliveryFee).toFixed(2);

    const orderData = {
      email: email,
      region: region,
      province: province,
      first_name: firstName,
      last_name: lastName,
      instagram: instagram,
      address: address,
      phone: phone,
      payment_method: paymentMethod.value,
      subtotal: subtotal.toFixed(2),
      discount: discountAmount.toFixed(2),
      delivery_fee: deliveryFee.toFixed(2),
      total: total,
      htmlContent: `
        <h2>Order Information</h2>
        <table border="1" cellpadding="8" cellspacing="0" style="border-collapse: collapse; width: 100%; font-family: Arial, sans-serif;">
          <tr><th align="left">Field</th><th align="left">Details</th></tr>
          <tr><td>Email</td><td>${email}</td></tr>
          <tr><td>Region</td><td>${region === 'pr' ? 'Provinces' : region === 'MY' ? 'Phnom Penh' : region}</td></tr>
          <tr><td>Province</td><td>${province || '-'}</td></tr>
          <tr><td>First Name</td><td>${firstName}</td></tr>
          <tr><td>Last Name</td><td>${lastName}</td></tr>
          <tr><td>Instagram</td><td>${instagram || '-'}</td></tr>
          <tr><td>Address</td><td>${address}</td></tr>
          <tr><td>Phone</td><td>${phone}</td></tr>
          <tr><td>Payment Method</td><td>${paymentMethod.value === 'paid' ? 'Paid' : 'Cash On Delivery (COD)'}</td></tr>
        </table>

        <h2>Order Summary</h2>
        <table border="1" cellpadding="8" cellspacing="0" style="border-collapse: collapse; width: 100%; font-family: Arial, sans-serif; margin-top: 10px;">
          <tr><th align="left">Item</th><th align="center">Qty</th><th align="center">Size</th><th align="right">Price</th></tr>
          ${itemsHtml}
          <tr>
            <td colspan="3" align="right"><strong>Subtotal</strong></td>
            <td align="right">$${subtotal.toFixed(2)}</td>
          </tr>
          ${discountRate > 0 ? `
          <tr>
            <td colspan="3" align="right"><strong>Discount</strong></td>
            <td align="right">-$${discountAmount.toFixed(2)}</td>
          </tr>` : ''}
          <tr>
            <td colspan="3" align="right"><strong>Delivery Fee</strong></td>
            <td align="right">$${deliveryFee.toFixed(2)}</td>
          </tr>
          <tr>
            <td colspan="3" align="right"><strong>Total</strong></td>
            <td align="right"><strong>$${total}</strong></td>
          </tr>
        </table>`
    };

    emailjs.send("service_4wz0hie", "template_ta8cfan", orderData)
      .then(function (response) {
        console.log("SUCCESS", response.status, response.text);
        alert("Order sent successfully!");
        localStorage.removeItem("cartData");
        window.location.href = "thankyou.html";
      }, function (error) {
        console.error("FAILED", error);
        alert("Failed to send order. Please check console for details.");
      });
  });

  renderOrderSummary();
});
</script>



</body>
</html>
